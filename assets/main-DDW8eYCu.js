import{c as T,a as y}from"./syncStore-FKy-NAE1.js";function g(e){const t=[...e];for(let r=t.length-1;r>0;r--){const d=Math.floor(Math.random()*(r+1));[t[r],t[d]]=[t[d],t[r]]}return t}function L(e,t){if(t>e.length)throw new Error(`Cannot pick ${t} items from array of length ${e.length}`);const r=[...e];return g(r).slice(0,t)}function E(e){const t=e*e,r=Math.ceil(t/3),d=r-1,l=t-(r+d+1),f=Math.random()<.5?"red":"blue",c=[];for(let i=0;i<t;i++)i<r?c.push("red"):i<r+d?c.push("blue"):i<r+d+l?c.push("neutral"):c.push("assassin");return{roles:g(c),startsFirst:f}}function C({size:e,words:t}){const r=e*e,d=L(t,r),s=E(e),l=s.roles,f=s.startsFirst;let c=1;const i={};return l.forEach((m,n)=>{m==="neutral"&&(i[n]=c++)}),{cells:d.map((m,n)=>({word:m,row:Math.floor(n/e),col:n%e,role:l[n],neutralNumber:i[n]||null,revealed:!1})),startsFirst:f}}const b={red:"blue",blue:"red"};function S(e,t){if(e.gameOver)return e;const r=e.cells[t];if(r.revealed)return e;const d=e.cells.map((f,c)=>c===t?{...f,revealed:!0}:f);if(r.role==="assassin")return{...e,cells:d,gameOver:!0,winner:b[e.activeTeam]};const l=r.role===e.activeTeam?e.activeTeam:b[e.activeTeam];return{...e,cells:d,activeTeam:l}}function O(e){return e.gameOver?e:{...e,activeTeam:b[e.activeTeam]}}function N(e){if(e.gameOver)return e.winner;const t=e.cells.filter(l=>l.role==="red"&&l.revealed).length,r=e.cells.filter(l=>l.role==="blue"&&l.revealed).length,d=e.cells.filter(l=>l.role==="red").length,s=e.cells.filter(l=>l.role==="blue").length;return t===d?"red":r===s?"blue":null}const M=["абзац","абонент","абрикос","авангард","август","автобус","автор","адрес","академик","аквариум","актер","алмаз","альбом","анализ","ангел","анекдот","апельсин","аппарат","апрель","арбуз","аргумент","аромат","артист","архив","аспект","астроном","аэропорт","багаж","базар","баланс","балкон","банк","барабан","барьер","баскетбол","батарея","башня","бегемот","берег","бетон","билет","бинокль","бизнес","блеск","блок","блокнот","блюдо","богатство","боец","бокал","болт","борщ","ботинок","бочка","брак","брат","бревно","бренд","броня","брус","бугор","букет","бумага","бункер","буря","бутылка","бык","вагон","валенок","валюта","вампир","вариант","ваза","вахта","ведро","век","ветер","вечер","взгляд","вилка","виноград","вирус","вишня","вклад","власть","внук","вода","воздух","вопрос","воск","восток","впечатление","врач","время","вулкан","выбор","вывод","газ","галерея","гараж","гармония","герой","гитара","глава","глаз","глина","гнев","гнездо","город","гора","горизонт","гость","градус","грамота","гранит","график","гроза","группа","груша","губа","давление","дверь","двигатель","двор","дедушка","действие","декан","дело","день","дерево","дефект","диалог","диван","директор","диск","договор","дождь","доклад","доктор","долг","дом","дорога","доска","доставка","друг","дружба","дуб","дума","дым","дыхание","еда","еж","желание","железо","жена","журнал","забор","завод","загадка","закон","зал","замок","запах","запас","заявление","звезда","звонок","здание","земля","зерно","зима","знак","золото","зонт","игра","идея","известие","изделие","изображение","имя","интерес","инструмент","июль","кабинет","кабель","кадр","казак","камень","канал","канат","капитан","капля","карман","картина","касса","каталог","квартира","кедр","кепка","кирпич","кисть","клавиша","класс","клетка","клиент","клуб","ключ","книга","ковер","код","кожа","колесо","коллекция","колокол","команда","комедия","комната","компьютер","конверт","конкурс","контакт","контроль","конфликт","концерт","корень","корзина","коридор","корм","корона","костюм","кот","кофе","кошка","кран","кредит","кресло","крест","крик","кровать","круг","крыло","крыша","куб","кукла","кулак","курс","кусок","куст","лампа","лес","лестница","лето","лидер","лист","лифт","лицо","лодка","ложка","локоть","луна","луч","магазин","май","мак","малина","мама","март","масло","мастер","машина","мебель","мед","медведь","месяц","металл","метод","меч","миг","микрофон","минута","мир","модель","мозг","молоко","молот","момент","монастырь","море","мост","мотор","музей","музыка","муж","мыло","мысль","мясо","набор","народ","насос","наука","начало","небо","неделя","нож","номер","нос","ночь","обед","облако","образ","обувь","огонь","одежда","озеро","океан","окно","операция","опыт","орех","оружие","остров","ответ","отец","охота","ошибка","пакет","палец","память","папа","парк","парта","паспорт","пейзаж","пена","песок","песня","печь","пиджак","пирог","письмо","план","платформа","плечо","площадь","победа","повод","погода","подарок","подвал","подушка","поезд","пожар","покупка","поле","полка","полёт","польза","помощь","понедельник","порт","портфель","посёлок","поток","потолок","праздник","предмет","пример","принцип","природа","причина","программа","продукт","проект","процесс","профессия","птица","путь","пчела","работа","радио","разговор","размер","ракета","рана","рассказ","ребёнок","река","ремонт","ресурс","речь","решение","рис","рисунок","робот","родина","роза","рот","рубль","рука","руководство","рынок","сад","самолёт","сапог","сахар","свет","свобода","село","семья","сентябрь","сердце","сигнал","сила","система","скала","склад","скорость","слово","слон","служба","смысл","снег","собака","собрание","совет","сок","солдат","солнце","сообщение","сосед","состав","состояние","спина","спорт","способ","спутник","среда","станция","стекло","стена","стол","страна","страх","стрела","студент","суббота","суд","сумка","сцена","счастье","сыр","театр","телефон","тело","тема","тетрадь","товар","ток","толпа","трава","трактор","транспорт","тренер","труд","туман","турист","угол","удар","улица","улыбка","ум","урок","успех","утро","фактор","фамилия","февраль","фильм","флот","форма","фраза","фрукт","футбол","характер","хлеб","хозяин","цвет","цель","центр","цепь","церковь","цех","цикл","цифра","чай","человек","четверг","число","член","чудо","шаг","шапка","шар","шахта","школа","шоколад","шум","щека","экзамен","экран","электрик","энергия","эпоха","этаж","юмор","юрист","яблоко","январь","язык","ящик"];function k(){const e=document.createElement("div");e.className="turn-modal",e.innerHTML=`
    <div class="turn-modal__content">
      <div class="turn-modal__text">Ooups! Get ready</div>
      <div class="turn-modal__team"></div>
      <div class="turn-modal__timer">3</div>
      <div class="turn-modal__text">Good luck!!</div>
    </div>
  `,document.body.appendChild(e);let t=null,r=null;function d(s,l){const f=e.querySelector(".turn-modal__content"),c=e.querySelector(".turn-modal__team"),i=e.querySelector(".turn-modal__timer");f.classList.remove("turn-modal__content--red","turn-modal__content--blue"),c.classList.remove("turn-modal__team--red","turn-modal__team--blue"),f.classList.add(`turn-modal__content--${s}`),c.classList.add(`turn-modal__team--${s}`),c.textContent=s==="red"?"RED":"BLUE",e.classList.add("turn-modal--visible");let u=3;i.textContent=u,r&&clearInterval(r),t&&clearTimeout(t),r=setInterval(()=>{u-=1,i.textContent=u},1e3),t=setTimeout(()=>{clearInterval(r),e.classList.remove("turn-modal--visible"),l&&l()},3e3)}return{show:d}}function q({size:e}){const t=T();let r=0;function d(){r+=1;const{cells:a,startsFirst:o}=C({size:e,words:M});return{gameId:r,size:e,cells:a,activeTeam:o,startingTeam:o,gameOver:!1,winner:null}}let s=t.getState()||d();const l=y(),f=k();let c=null;function i(){c&&(u(c),c=null)}function u(a){const o=N(a);o&&(a={...a,gameOver:!0,winner:o}),s=a,t.setState(s),l.emit(s)}t.subscribe(a=>{JSON.stringify(s)!==JSON.stringify(a)&&(s=a,l.emit(s))});function m(a){if(s.gameOver)return;const o=S(s,a);o.activeTeam!==s.activeTeam?(c=o,f.show(o.activeTeam,i)):u(o)}function n(){s.gameOver||(c=O(s),f.show(c.activeTeam,i))}function v(){u(d())}return{getState:()=>({...s}),subscribe:l.subscribe,reveal:m,endTurn:n,reset:v}}const w="/codenames/assets/qr-code-BV_h1V0y.png";function R({container:e,store:t}){e.innerHTML=`
    <header class="header">
      <div class="header__left">
        <div class="header__team-container">
          <span class="header__team-label">TEAM</span>
          <div class="header__team"></div>
        </div>
      </div>
      <div class="header__right">
        <button class="header__button header__button--menu">QR</button>
        <button class="header__button header__button--turn">END TURN</button>
        <button class="header__button header__button--new">NEW GAME</button>
      </div>
    </header>
  `;const r=e.querySelector(".header__team"),d=e.querySelector(".header__button--new"),s=e.querySelector(".header__button--turn"),l=e.querySelector(".header__button--menu");function f(){const u=document.querySelector(".modal-overlay");u&&u.remove();const m=document.createElement("div");m.className="modal-overlay",m.innerHTML=`
      <div class="modal modal--qr">
        <div class="modal__header">
          <h2 class="modal__title">MINI MAP</h2>
          <button class="modal__close">✕</button>
        </div>
        <div class="modal__content modal__content--qr">
          <div class="qr-container">
            <img src="${w}" alt="QR Code" class="qr-image">
            <p class="qr-description">Scan to open</p>
          </div>
        </div>
      </div>
    `,document.body.appendChild(m),setTimeout(()=>{m.classList.add("active")},10);function n(){m.classList.remove("active"),setTimeout(()=>{m.remove()},300)}const v=m.querySelector(".modal__close"),a=m.querySelector(".modal__button");v.addEventListener("click",n),a.addEventListener("click",n),m.addEventListener("click",_=>{_.target===m&&n()});const o=_=>{_.key==="Escape"&&(n(),document.removeEventListener("keydown",o))};document.addEventListener("keydown",o)}function c(u){var m;u&&(u.gameOver?r.textContent=`${(m=u.winner)==null?void 0:m.toUpperCase()} WINS!`:r.textContent=u.activeTeam==="red"?"RED":"BLUE",document.body.classList.remove("team-red","team-blue"),!u.gameOver&&u.activeTeam&&document.body.classList.add(`team-${u.activeTeam}`))}function i(u){c(u)}d.addEventListener("click",()=>{t.reset()}),s.addEventListener("click",()=>{t.getState().gameOver||t.endTurn()}),l.addEventListener("click",f),t.subscribe(i),c(t.getState())}function p(e){const t=e.length;return t<=4?"52px":t<=8?"44px":t<=10?"40px":t<=12?"36px":"28px"}function x({container:e,store:t}){const r=document.createElement("div");r.className="grid",e.innerHTML="",e.appendChild(r);const d=new Map;function s(n,v){const a="grid__cell";let o;if(!v.revealed)o="grid__cell--hidden";else switch(v.role){case"red":o="grid__cell--red";break;case"blue":o="grid__cell--blue";break;case"neutral":o="grid__cell--neutral";break;case"assassin":o="grid__cell--assassin";break;default:o="grid__cell--hidden"}n.className=`${a} ${o}`,n.dataset.role=v.role,v.role==="neutral"&&v.neutralNumber&&v.revealed&&n.classList.add(`grid__cell--neutral-${v.neutralNumber}`),n.dataset.revealed=String(v.revealed),n.dataset.neutralNumber=v.neutralNumber||"",n.style.fontSize=p(v.word)}function l(n,v){const a=document.createElement("button");return a.className="grid__cell grid__cell--hidden",a.dataset.index=v,a.dataset.role=n.role,a.dataset.revealed="false",a.dataset.neutralNumber=n.neutralNumber||"",a.textContent=n.word,a.style.fontSize=p(n.word),a.style.wordBreak="break-word",a.style.hyphens="auto",a.addEventListener("click",()=>{t.reveal(v)}),a}function f(n){r.innerHTML="",d.clear(),n.cells.forEach((v,a)=>{const o=l(v,a);r.appendChild(o),d.set(a,o)})}function c(n,v){n.cells.forEach((a,o)=>{const _=v.cells[o],h=d.get(o);!h||!(_.revealed!==a.revealed||_.neutralNumber!==a.neutralNumber||_.role!==a.role||_.word!==a.word)||(_.word!==a.word&&(h.textContent=a.word),s(h,a))})}let i=null;function u(n){if(!i){f(n),i=n,n.gameOver&&r.classList.add("game-over");return}if(n.gameId!==i.gameId){f(n),i=n,n.gameOver?r.classList.add("game-over"):r.classList.remove("game-over");return}c(n,i),n.gameOver!==i.gameOver&&(n.gameOver?r.classList.add("game-over"):r.classList.remove("game-over")),i=n}const m=t.subscribe(u);return u(t.getState()),()=>{m(),d.clear()}}function B({root:e,store:t}){e.innerHTML=`
    <div class="app">
      <div class="app__header"></div>
      <div class="app__grid"></div>
    </div>
  `,R({container:e.querySelector(".app__header"),store:t}),x({container:e.querySelector(".app__grid"),store:t})}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#app");if(!e){console.error("Root element #app not found");return}const t=q({size:5});B({root:e,store:t})});
